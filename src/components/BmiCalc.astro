---
const testimonials = [
    { name: "Daryl", pounds: "72 POUNDS", image: "/images/slide2.jpg" },
    { name: "Sarah", pounds: "58 POUNDS", image: "/images/slide1.jpg" },
    { name: "Mary", pounds: "65 POUNDS", image: "/images/slide3.jpg" },
];
---

<section class="bmi-calculator-section">
    <div class="bmi-container">
        <!-- Left Panel: Input Form -->
        <div class="bmi-input-panel">
            <h2 class="bmi-title">Check your BMI</h2>
            <p class="bmi-subtitle">Enter your height and weight below</p>

            <div class="bmi-display">0</div>

            <form class="bmi-form">
                <div class="form-group">
                    <label class="form-label">Height</label>
                    <div class="input-row">
                        <div class="input-wrapper">
                            <input
                                type="number"
                                id="feet"
                                placeholder="Feet"
                                class="form-input"
                                min="0"
                                max="8"
                            />
                            <span class="input-unit">ft</span>
                        </div>
                        <div class="input-wrapper">
                            <input
                                type="number"
                                id="inches"
                                placeholder="Inches"
                                class="form-input"
                                min="0"
                                max="11"
                            />
                            <span class="input-unit">in</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Weight</label>
                    <div class="input-wrapper single">
                        <input
                            type="number"
                            id="weight"
                            placeholder="Weight (pounds)"
                            class="form-input"
                            min="0"
                        />
                        <span class="input-unit">lbs</span>
                    </div>
                </div>

                <button type="button" class="calculate-btn" id="calculateBtn">
                    Calculate BMI
                </button>
            </form>
        </div>

        <!-- Center Panel: Testimonial Slideshow -->
        <div class="bmi-testimonial-panel">
            <div class="testimonial-slideshow-bmi">
                {
                    testimonials.map((testimonial, index) => (
                        <div class={`slide-bmi ${index === 0 ? "active" : ""}`}>
                            <img
                                src={testimonial.image}
                                alt={`${testimonial.name}'s transformation`}
                                class="testimonial-image-bmi"
                            />
                            <div class="testimonial-info-bmi">
                                <h3 class="testimonial-name-bmi">{testimonial.name}</h3>
                                <p class="testimonial-weight-bmi">
                                    LOST {testimonial.pounds}
                                </p>
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>

        <!-- Right Panel: Results -->
        <div class="bmi-results-panel">
            <div class="results-content" id="resultsContent">
                <p class="results-label">You could lose:</p>
                <div class="weight-loss-display">
                    <span class="weight-number" id="weightLoss">0</span>
                    <span class="weight-unit">lbs</span>
                </div>

                <div class="bar-chart" id="barChart">
                    <div class="chart-bars">
                        <!-- Bars will be generated dynamically -->
                    </div>
                    <div class="chart-marker">â–¼</div>
                </div>

                <div class="weight-slider-section">
                    <div class="starting-weight-badge">
                        <span class="badge-label">Starting weight:</span>
                        <span class="badge-value" id="startingWeight">0</span>
                        <span class="badge-unit">lbs</span>
                    </div>

                    <div class="weight-slider">
                        <div class="slider-track">
                            <div class="slider-gradient"></div>
                            <div class="slider-thumb" id="sliderThumb"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- BMI Results Modal -->
<div class="bmi-results-modal-overlay" id="bmiResultsModal">
    <div class="bmi-results-modal-container">
        <button class="bmi-results-modal-close" id="closeBMIResultsModal" aria-label="Close">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path
                    d="M18 6L6 18M6 6l12 12"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                />
            </svg>
        </button>

        <div class="bmi-results-modal-grid">
            <!-- Left Side: BMI Circle -->
            <div class="bmi-results-modal-left">
                <h2 class="bmi-results-modal-title">Body Mass Index</h2>

                <div class="bmi-results-circle-container">
                    <svg class="bmi-results-circle" viewBox="0 0 200 200">
                        <circle
                            cx="100"
                            cy="100"
                            r="80"
                            fill="none"
                            stroke="#f0f0f0"
                            stroke-width="16"
                        />
                        <circle
                            id="bmiResultsArc"
                            cx="100"
                            cy="100"
                            r="80"
                            fill="none"
                            stroke="#89cff0"
                            stroke-width="16"
                            stroke-dasharray="502"
                            stroke-dashoffset="125"
                            stroke-linecap="round"
                            transform="rotate(-90 100 100)"
                        />
                    </svg>
                    <div class="bmi-results-value-container">
                        <div class="bmi-results-value" id="bmiResultsValue">0</div>
                        <div class="bmi-results-label">Your BMI</div>
                    </div>
                </div>

                <div class="bmi-results-explanation">
                    <p>
                        Body Mass Index (BMI) is a measurement tool that uses your height and
                        weight to estimate if your weight is in a healthy range for your height.*
                    </p>
                </div>
            </div>

            <!-- Right Side: Category Info -->
            <div class="bmi-results-modal-right">
                <div class="bmi-results-category-alert" id="categoryResultsAlert">
                    <div class="bmi-results-alert-header">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path
                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
                        <span class="bmi-results-alert-category" id="alertResultsCategory">Underweight</span>
                        <span class="bmi-results-alert-range" id="alertResultsRange">&lt; 18.5</span>
                    </div>
                    <p class="bmi-results-alert-text" id="alertResultsText">
                        Your BMI is below the healthy range.
                    </p>
                    <button class="bmi-results-consultation-btn">Start Consultation</button>
                </div>

                <div class="bmi-results-categories">
                    <div class="bmi-results-category-item">
                        <div class="bmi-results-category-dot healthy"></div>
                        <span class="bmi-results-category-name">Healthy Weight</span>
                        <span class="bmi-results-category-range">18.5+</span>
                    </div>
                    <div class="bmi-results-category-item">
                        <div class="bmi-results-category-dot overweight"></div>
                        <span class="bmi-results-category-name">Overweight</span>
                        <span class="bmi-results-category-range">25+</span>
                    </div>
                    <div class="bmi-results-category-item">
                        <div class="bmi-results-category-dot obese"></div>
                        <span class="bmi-results-category-name">Obesity</span>
                        <span class="bmi-results-category-range">30+</span>
                    </div>
                </div>

                <div class="bmi-results-disclaimers">
                    <p>
                        *BMI doesn't directly measure body fat and may not accurately reflect health
                        for people with high muscle mass, pregnant women, children, older adults,
                        certain ethnic groups, or those with medical conditions.
                    </p>
                    <p>
                        The BMI calculator does not determine eligibility for weight loss treatments. A
                        healthcare provider must evaluate your overall health and history to decide if
                        treatment is right for you.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bmi-calculator-section {
            padding: 20px 0;
        max-width: 1400px;
        margin: 0 auto;
        background-color: #faf8f2;
    }

    .bmi-container {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
        align-items: stretch;
    }

    /* Left Panel: Input Form */
    .bmi-input-panel {
        background-color: #ffffff;
        border-radius: 60px;
        padding: 60px 50px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .bmi-title {
        font-family: "Sofia";
        font-size: 32px;
        font-weight: 400;
        color: #030303;
        margin-bottom: 8px;
    }

    .bmi-subtitle {
        font-size: 16px;
        color: #666;
        margin-bottom: 40px;
        font-weight: 400;
    }

    .bmi-display {
        font-size: 120px;
        font-weight: 700;
        color: #030303;
        margin-bottom: 40px;
        line-height: 1;
    }

    .form-group {
        margin-bottom: 32px;
    }

    .form-label {
        display: block;
        font-size: 16px;
        color: #030303;
        margin-bottom: 12px;
        font-weight: 500;
    }

    .input-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
    }

    .input-wrapper {
        position: relative;
        background-color: #f8f8f8;
        border-radius: 16px;
        border: 2px solid transparent;
        transition: all 0.3s ease;
    }

    .input-wrapper.single {
        grid-column: 1 / -1;
    }

    .input-wrapper:focus-within {
        border-color: #0070da;
        background-color: #ffffff;
    }

    .form-input {
        width: 100%;
        padding: 18px 20px;
        font-size: 16px;
        border: none;
        background: transparent;
        outline: none;
        color: #030303;
    }

    .form-input::placeholder {
        color: #999;
    }

    .input-unit {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 16px;
        color: #666;
        pointer-events: none;
    }

    .calculate-btn {
        width: 100%;
        padding: 20px;
        background: linear-gradient(
            135deg,
            #ff6b9d 0%,
            #ffa06b 50%,
            #ffd56b 100%
        );
        border: 2px solid transparent;
        border-radius: 50px;
        font-size: 18px;
        font-weight: 500;
        color: #030303;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Inter";
    }

    .calculate-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 107, 157, 0.3);
        border-color: #0070da;
    }

    .calculate-btn:active {
        transform: translateY(0);
    }

    /* Center Panel: Testimonial Slideshow */
    .bmi-testimonial-panel {
        background: linear-gradient(135deg, #00295f 0%, #004080 100%);
        border-radius: 60px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .testimonial-slideshow-bmi {
        position: relative;
        width: 100%;
        height: 100%;
        min-height: 400px;
    }

    .slide-bmi {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        display: flex;
        flex-direction: column;
    }

    .slide-bmi.active {
        opacity: 1;
        z-index: 1;
    }

    .testimonial-image-bmi {
        width: 100%;
        height: 70%;
        object-fit: cover;
    }

    .testimonial-info-bmi {
        background: linear-gradient(135deg, #278fc3 0%, #00295f 100%);
        padding: 30px 40px;
        display: flex;
        flex-direction: column;
        gap: 12px;
        flex: 1;
    }

    .testimonial-name-bmi {
        font-family: "Sofia";
        font-size: 32px;
        font-weight: 400;
        color: white;
        margin: 0;
    }

    .testimonial-weight-bmi {
        font-size: 16px;
        font-weight: 600;
        color: white;
        margin: 0;
    }

    /* Right Panel: Results */
    .bmi-results-panel {
        background-color: #ffffff;
        border-radius: 60px;
        padding: 60px 50px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .results-content {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .results-label {
        font-size: 16px;
        color: #666;
        margin-bottom: 16px;
        text-align: right;
    }

    .weight-loss-display {
        text-align: right;
        margin-bottom: 40px;
    }

    .weight-number {
        font-size: 120px;
        font-weight: 700;
        color: #030303;
        line-height: 1;
    }

    .weight-unit {
        font-size: 48px;
        font-weight: 400;
        color: #030303;
    }

    /* Bar Chart */
    .bar-chart {
        position: relative;
        margin-bottom: 40px;
    }

    .chart-bars {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        gap: 4px;
        height: 120px;
        padding: 0 20px;
    }

    .chart-bar {
        flex: 1;
        background: linear-gradient(to top, #4e9a69, #aec8ae);
        border-radius: 4px 4px 0 0;
        transition: all 0.3s ease;
        min-width: 8px;
    }

    .chart-marker {
        position: absolute;
        right: 20px;
        top: -24px;
        font-size: 24px;
        color: #4e9a69;
    }

    /* Weight Slider */
    .weight-slider-section {
        margin-top: auto;
    }

    .starting-weight-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background-color: #00875a;
        color: #ffffff;
        padding: 12px 24px;
        border-radius: 12px;
        margin-bottom: 20px;
        font-weight: 500;
    }

    .badge-label {
        font-size: 14px;
    }

    .badge-value {
        font-size: 24px;
        font-weight: 700;
    }

    .badge-unit {
        font-size: 16px;
    }

    .weight-slider {
        position: relative;
        padding: 20px 0;
    }

    .slider-track {
        position: relative;
        height: 16px;
        background-color: #f0f0f0;
        border-radius: 20px;
        border: 3px solid #0070da;
        overflow: visible;
    }

    .slider-gradient {
        height: 100%;
        background: linear-gradient(
            to right,
            #ff6b6b 0%,
            #ffa06b 25%,
            #ffd56b 50%,
            #89cff0 75%,
            #4e9a69 100%
        );
        border-radius: 20px;
    }

    .slider-thumb {
        position: absolute;
        top: 50%;
        left: 20%;
        transform: translate(-50%, -50%);
        width: 28px;
        height: 28px;
        background-color: #ffffff;
        border: 3px solid #666;
        border-radius: 50%;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        transition: left 0.3s ease;
    }

    /* Modal Styles */
    .bmi-results-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .bmi-results-modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .bmi-results-modal-container {
        background-color: #ffffff;
        border-radius: 48px;
        max-width: 1200px;
        width: 100%;
        padding: 60px;
        position: relative;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        transform: scale(0.9);
        transition: transform 0.3s ease;
        max-height: 90vh;
        overflow-y: auto;
    }

    .bmi-results-modal-overlay.active .bmi-results-modal-container {
        transform: scale(1);
    }

    .bmi-results-modal-close {
        position: absolute;
        top: 32px;
        right: 32px;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        color: #030303;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s ease;
        z-index: 10;
    }

    .bmi-results-modal-close:hover {
        transform: rotate(90deg);
    }

    .bmi-results-modal-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 60px;
    }

    .bmi-results-modal-left {
        background: linear-gradient(135deg, #f8f4ff 0%, #fff8f4 100%);
        border: 3px solid;
        border-image: linear-gradient(135deg, #ff6b9d, #ffa06b, #ffd56b) 1;
        border-radius: 32px;
        padding: 50px 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .bmi-results-modal-title {
        font-family: "Sofia";
        font-size: 32px;
        font-weight: 400;
        color: #030303;
        margin-bottom: 40px;
        text-align: center;
    }

    .bmi-results-circle-container {
        position: relative;
        width: 280px;
        height: 280px;
        margin-bottom: 40px;
    }

    .bmi-results-circle {
        width: 100%;
        height: 100%;
    }

    .bmi-results-value-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
    }

    .bmi-results-value {
        font-size: 64px;
        font-weight: 700;
        color: #030303;
        line-height: 1;
        margin-bottom: 8px;
    }

    .bmi-results-label {
        font-size: 16px;
        color: #666;
    }

    .bmi-results-explanation {
        font-size: 14px;
        color: #666;
        line-height: 1.6;
        text-align: center;
    }

    .bmi-results-modal-right {
        display: flex;
        flex-direction: column;
        gap: 32px;
    }

    .bmi-results-category-alert {
        background: linear-gradient(135deg, #e8f4ff 0%, #f0f8ff 100%);
        border: 2px solid #89cff0;
        border-radius: 24px;
        padding: 32px;
    }

    .bmi-results-alert-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
    }

    .bmi-results-alert-header svg {
        color: #0070da;
        flex-shrink: 0;
    }

    .bmi-results-alert-category {
        font-size: 20px;
        font-weight: 600;
        color: #030303;
        flex: 1;
    }

    .bmi-results-alert-range {
        font-size: 16px;
        color: #666;
        font-weight: 500;
    }

    .bmi-results-alert-text {
        font-size: 14px;
        color: #030303;
        line-height: 1.6;
        margin-bottom: 24px;
    }

    .bmi-results-consultation-btn {
        width: 100%;
        padding: 16px 32px;
        background-color: #030303;
        color: #ffffff;
        border: none;
        border-radius: 50px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Inter";
    }

    .bmi-results-consultation-btn:hover {
        background-color: #0070da;
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 112, 218, 0.3);
    }

    .bmi-results-categories {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .bmi-results-category-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px 20px;
        background-color: #f8f8f8;
        border-radius: 16px;
    }

    .bmi-results-category-dot {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        flex-shrink: 0;
    }

    .bmi-results-category-dot.healthy {
        background-color: #4e9a69;
    }

    .bmi-results-category-dot.overweight {
        background-color: #ffa06b;
    }

    .bmi-results-category-dot.obese {
        background-color: #ff6b6b;
    }

    .bmi-results-category-name {
        flex: 1;
        font-size: 16px;
        color: #030303;
        font-weight: 500;
    }

    .bmi-results-category-range {
        font-size: 16px;
        color: #666;
        font-weight: 600;
    }

    .bmi-results-disclaimers {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .bmi-results-disclaimers p {
        font-size: 12px;
        color: #666;
        line-height: 1.6;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
        .bmi-container {
            grid-template-columns: 1fr;
            gap: 24px;
        }

        .bmi-testimonial-panel {
            order: -1;
        }

        .bmi-results-modal-grid {
            grid-template-columns: 1fr;
            gap: 40px;
        }
    }

    @media (max-width: 768px) {
        .bmi-calculator-section {
            padding: 40px 24px;
        }

        .bmi-input-panel,
        .bmi-results-panel {
            padding: 40px 32px;
            border-radius: 40px;
        }

        .bmi-testimonial-panel {
            border-radius: 40px;
        }

        .bmi-title {
            font-size: 28px;
        }

        .bmi-display,
        .weight-number {
            font-size: 80px;
        }

        .weight-unit {
            font-size: 32px;
        }

        .chart-bars {
            height: 100px;
        }

        .testimonial-slideshow-bmi {
            min-height: 350px;
        }

        .testimonial-name-bmi {
            font-size: 24px;
        }

        .testimonial-info-bmi {
            padding: 24px 32px;
        }

        .bmi-results-modal-container {
            padding: 40px 32px;
            border-radius: 32px;
        }

        .bmi-results-modal-close {
            top: 20px;
            right: 20px;
        }

        .bmi-results-modal-title {
            font-size: 28px;
        }

        .bmi-results-circle-container {
            width: 240px;
            height: 240px;
        }

        .bmi-results-value {
            font-size: 56px;
        }

        .bmi-results-modal-left {
            padding: 40px 32px;
        }

        .bmi-results-category-alert {
            padding: 24px;
        }
    }
</style>

<script>
    const feetInput = document.getElementById("feet");
    const inchesInput = document.getElementById("inches");
    const weightInput = document.getElementById("weight");
    const calculateBtn = document.getElementById("calculateBtn");
    const bmiDisplay = document.querySelector(".bmi-display");
    const weightLossDisplay = document.getElementById("weightLoss");
    const startingWeightDisplay = document.getElementById("startingWeight");
    const sliderThumb = document.getElementById("sliderThumb");
    const chartBarsContainer = document.querySelector(".chart-bars");
    const bmiResultsModal = document.getElementById("bmiResultsModal");
    const closeBMIResultsModalBtn = document.getElementById("closeBMIResultsModal");

    // Generate initial bar chart
    function generateBarChart(weeks = 24) {
        chartBarsContainer.innerHTML = "";
        for (let i = 0; i < weeks; i++) {
            const bar = document.createElement("div");
            bar.className = "chart-bar";
            const height = 100 - i * 3.5;
            bar.style.height = Math.max(height, 20) + "%";
            chartBarsContainer.appendChild(bar);
        }
    }

    generateBarChart();

    function updateModalBMI(bmi) {
        const bmiResultsValue = document.getElementById("bmiResultsValue");
        const categoryResultsAlert = document.getElementById("categoryResultsAlert");
        const alertResultsCategory = document.getElementById("alertResultsCategory");
        const alertResultsRange = document.getElementById("alertResultsRange");
        const alertResultsText = document.getElementById("alertResultsText");
        const bmiResultsArc = document.getElementById("bmiResultsArc");

        bmiResultsValue.textContent = bmi.toFixed(1);

        let category, color, range, text;

        if (bmi < 18.5) {
            category = 'Underweight';
            color = '#89cff0';
            range = '< 18.5';
            text = 'Your BMI is below the healthy range. A licensed provider can help explore the underlying causes and guide you toward a safe, sustainable plan for reaching a healthier weight.';
        } else if (bmi < 25) {
            category = 'Healthy Weight';
            color = '#4e9a69';
            range = '18.5+';
            text = 'Your BMI is within the healthy range. Maintaining a balanced diet and regular exercise can help you stay healthy.';
        } else if (bmi < 30) {
            category = 'Overweight';
            color = '#ffa06b';
            range = '25+';
            text = 'Your BMI indicates you are overweight. A licensed provider can help you develop a personalized plan to reach a healthier weight.';
        } else {
            category = 'Obesity';
            color = '#ff6b6b';
            range = '30+';
            text = 'Your BMI indicates obesity. We recommend consulting with a licensed provider to explore treatment options that may be right for you.';
        }

        alertResultsCategory.textContent = category;
        alertResultsRange.textContent = range;
        alertResultsText.textContent = text;
        categoryResultsAlert.style.borderColor = color;
        bmiResultsArc.setAttribute('stroke', color);

        const percentage = Math.min(bmi / 40, 1);
        const dashOffset = 502 - (502 * percentage * 0.75);
        bmiResultsArc.setAttribute('stroke-dashoffset', dashOffset.toString());
    }

    function calculateBMI() {
        const feet = parseFloat(feetInput.value) || 0;
        const inches = parseFloat(inchesInput.value) || 0;
        const weight = parseFloat(weightInput.value) || 0;

        if (feet === 0 || weight === 0) {
            alert("Please enter valid height and weight");
            return;
        }

        const totalInches = feet * 12 + inches;
        const bmi = (weight / (totalInches * totalInches)) * 703;
        bmiDisplay.textContent = bmi.toFixed(1);

        const minHealthyWeight = (18.5 * totalInches * totalInches) / 703;
        const maxHealthyWeight = (24.9 * totalInches * totalInches) / 703;

        let targetWeight = maxHealthyWeight;
        if (weight > maxHealthyWeight) {
            targetWeight = maxHealthyWeight;
        } else if (weight < minHealthyWeight) {
            targetWeight = minHealthyWeight;
        }

        const weightLoss = Math.abs(weight - targetWeight);
        weightLossDisplay.textContent = Math.round(weightLoss);
        startingWeightDisplay.textContent = Math.round(weight);

        let sliderPosition = 50;
        if (bmi < 18.5) {
            sliderPosition = 10;
        } else if (bmi < 25) {
            sliderPosition = 50;
        } else if (bmi < 30) {
            sliderPosition = 70;
        } else {
            sliderPosition = 85;
        }

        sliderThumb.style.left = sliderPosition + "%";

        const bars = document.querySelectorAll(".chart-bar");
        bars.forEach((bar, index) => {
            setTimeout(() => {
                const newHeight = 100 - index * (weightLoss / 10);
                bar.style.height = Math.max(newHeight, 20) + "%";
            }, index * 30);
        });

        // Update modal and show it
        updateModalBMI(bmi);
        bmiResultsModal.classList.add("active");
        document.body.style.overflow = "hidden";
    }

    function closeBMIResultsModal() {
        bmiResultsModal.classList.remove("active");
        document.body.style.overflow = "";
    }

    calculateBtn.addEventListener("click", calculateBMI);
    closeBMIResultsModalBtn.addEventListener("click", closeBMIResultsModal);

    [feetInput, inchesInput, weightInput].forEach((input) => {
        input.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                calculateBMI();
            }
        });
    });

    // Close modal on overlay click
    bmiResultsModal.addEventListener("click", (e) => {
        if (e.target === bmiResultsModal) {
            closeBMIResultsModal();
        }
    });

    // Close modal on escape key
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && bmiResultsModal.classList.contains("active")) {
            closeBMIResultsModal();
        }
    });

    // Testimonial slideshow
    let currentSlide = 0;
    let isPaused = false;
    let slideInterval;

    function showSlide(index) {
        const slides = document.querySelectorAll(".slide-bmi");
        slides.forEach((slide, i) => {
            if (i === index) {
                slide.classList.add("active");
            } else {
                slide.classList.remove("active");
            }
        });
    }

    function nextSlide() {
        if (!isPaused) {
            const slides = document.querySelectorAll(".slide-bmi");
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }
    }

    function startSlideshow() {
        slideInterval = setInterval(nextSlide, 5000);
    }

    function stopSlideshow() {
        clearInterval(slideInterval);
    }

    const slideshow = document.querySelector(".testimonial-slideshow-bmi");

    if (slideshow) {
        startSlideshow();

        slideshow.addEventListener("mouseenter", () => {
            isPaused = true;
        });

        slideshow.addEventListener("mouseleave", () => {
            isPaused = false;
        });
    }
</script>